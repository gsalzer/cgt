{"status": "1", "message": "OK", "result": [{"SourceCode": "pragma solidity ^0.4.16;\r\n\r\ncontract koth_v1b {\r\n    event NewKoth(\r\n        uint gameId,\r\n        uint betNumber,\r\n        address bettor,\r\n        uint bet,\r\n        uint pot,\r\n        uint lastBlock,\r\n        uint minBet,\r\n        uint maxBet\r\n    );\r\n\r\n    event KothWin(\r\n        uint gameId,\r\n        uint totalBets,\r\n        address winner,\r\n        uint winningBet,\r\n        uint pot,\r\n        uint fee,\r\n        uint firstBlock,\r\n        uint lastBlock\r\n    );\r\n\r\n    // Constants\r\n    uint public constant minPot = 0.001 ether; // Contract needs to be endowed with this amount\r\n    uint public constant minRaise = 0.001 ether;\r\n    address feeAddress;\r\n\r\n    // Other internal variables\r\n    uint public gameId = 0;\r\n    uint public betId;\r\n    uint public highestBet;\r\n    uint public pot;\r\n    uint public firstBlock;\r\n    uint public lastBlock;\r\n    address public koth;\r\n\r\n    // Initialization\r\n    function koth_v1b() public {\r\n        feeAddress = msg.sender;\r\n        resetKoth();\r\n    }\r\n\r\n    function () payable public {\r\n        // We're past the block target, but new game hasn't been activated\r\n        if (lastBlock > 0 && block.number > lastBlock) {\r\n            msg.sender.transfer(msg.value);\r\n            return;\r\n        }\r\n\r\n        // Check for minimum bet (at least minRaise over current highestBet)\r\n        uint minBet = highestBet + minRaise;\r\n        if (msg.value < minBet) {\r\n            msg.sender.transfer(msg.value);\r\n            return;\r\n        }\r\n\r\n        // Check for maximum bet\r\n        uint maxBet;\r\n        if (pot < 1 ether) {\r\n            maxBet = 3 * pot;\r\n        } else {\r\n            maxBet = 5 * pot / 4;\r\n        }\r\n\r\n        // Check for maximum bet\r\n        if (msg.value > maxBet) {\r\n            msg.sender.transfer(msg.value);\r\n            return;\r\n        }\r\n\r\n        // Bet was successful\r\n        betId++;\r\n        highestBet = msg.value;\r\n        koth = msg.sender;\r\n        pot += highestBet;\r\n\r\n        // Equation expects pot to be in Ether\r\n        uint potEther = pot/1000000000000000000;\r\n        uint blocksRemaining = (potEther ** 2)/2 - 8*potEther + 37;\r\n        if (blocksRemaining < 6) {\r\n            blocksRemaining = 3;\r\n        }\r\n\r\n        lastBlock = block.number + blocksRemaining;\r\n\r\n        NewKoth(gameId, betId, koth, highestBet, pot, lastBlock, minBet, maxBet);\r\n    }\r\n\r\n    function resetKoth() private {\r\n        gameId++;\r\n        highestBet = 0;\r\n        koth = address(0);\r\n        pot = minPot;\r\n        lastBlock = 0;\r\n        betId = 0;\r\n        firstBlock = block.number;\r\n    }\r\n\r\n    // Called to reward current KOTH winner and start new game\r\n    function rewardKoth() public {\r\n        if (msg.sender == feeAddress && lastBlock > 0 && block.number > lastBlock) {\r\n            uint fee = pot / 20; // 5%\r\n            KothWin(gameId, betId, koth, highestBet, pot, fee, firstBlock, lastBlock);\r\n\r\n            uint netPot = pot - fee;\r\n            address winner = koth;\r\n            resetKoth();\r\n            winner.transfer(netPot);\r\n\r\n            // Make sure we never go below minPot\r\n            if (this.balance - fee >= minPot) {\r\n                feeAddress.transfer(fee);\r\n            }\r\n        }\r\n    }\r\n\r\n    function addFunds() payable public {\r\n        if (msg.sender != feeAddress) {\r\n            msg.sender.transfer(msg.value);\r\n        }\r\n    }\r\n\r\n    function kill() public {\r\n        if (msg.sender == feeAddress) {\r\n            selfdestruct(feeAddress);\r\n        }\r\n    }\r\n}", "ABI": "[{\"constant\":true,\"inputs\":[],\"name\":\"koth\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"firstBlock\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"betId\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"kill\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"pot\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"lastBlock\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"highestBet\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"addFunds\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"minPot\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"rewardKoth\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"minRaise\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"gameId\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"fallback\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"gameId\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"betNumber\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"bettor\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"bet\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"pot\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"lastBlock\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"minBet\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"maxBet\",\"type\":\"uint256\"}],\"name\":\"NewKoth\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"gameId\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"totalBets\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"winner\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"winningBet\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"pot\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"fee\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"firstBlock\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"lastBlock\",\"type\":\"uint256\"}],\"name\":\"KothWin\",\"type\":\"event\"}]", "ContractName": "koth_v1b", "CompilerVersion": "v0.4.16+commit.d7661dd9", "OptimizationUsed": "1", "Runs": "200", "ConstructorArguments": "", "Library": "", "SwarmSource": "bzzr://62f4112e9a48bad241bf5faf2f287018784d31c0dc85c700fbab57fb6d1e2a7c"}]}