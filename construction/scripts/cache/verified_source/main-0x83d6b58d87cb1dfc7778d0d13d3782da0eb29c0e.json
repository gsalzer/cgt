{"status": "1", "message": "OK", "result": [{"SourceCode": "contract TheEthereumLottery {\r\n /*\r\n    Brief introduction:\r\n    \r\n    To play you need to pick 4 numbers (range 0-255) and provide them sorted to Play() function.\r\n    To win you need to hit at least 1 number out of 4 WinningNums which will be announced once every week\r\n    (or more often if the lottery will become more popular). If you hit all of the 4 numbers you will win\r\n    about 50 milion times more than you payed fot lottery ticket. The exact values are provided as GuessXOutOf4\r\n    entries in Ledger - notice that they are provided in Wei, not Ether (10^18 Wei = Ether).\r\n    Use Withdraw() function to pay out.\r\n\r\n\r\n    The advantage of TheEthereumLottery is that it is not using any pseudo-random numbers.\r\n    The winning numbers are known from the announcement of next draw - at this moment the values of GuessXOutOf4,\r\n    and ticket price is publically available. \r\n    To unable cheating of contract owner there a hash (called \"TheHash\" in contract ledger) \r\n    equal to sha3(WinningNums, TheRand) is provided.\r\n    While announcing WinningNums the owner has to provide also a valid \"TheRand\" value, which satisfy \r\n    following expression: TheHash == sha3(WinningNums, TheRand). \r\n    If hashes do not match - the player can refund his Ether used for lottery ticket.\r\n    As by default all non existing values equal to 0, from the perspective of blockchain \r\n    the hashes do not match at the moment of announcing next draw from the perspective of blockchain. \r\n    This is why refund is possible only after 2 weeks of announcing next draw,\r\n    this moment is called ExpirencyTime on contract Ledger.\r\n */\r\n/*\r\n  Name:\r\n  TheEthereumLottery\r\n\r\n  Contract Address:\r\n  0x7698392fff47d8d4cee21295ad1f31b6ced9ad66\r\n\r\n  JSON interface:\r\n\r\n[{\"constant\":false,\"inputs\":[{\"name\":\"MyNum1\",\"type\":\"uint8\"},{\"name\":\"MyNum2\",\"type\":\"uint8\"},{\"name\":\"MyNum3\",\"type\":\"uint8\"},{\"name\":\"MyNum4\",\"type\":\"uint8\"}],\"name\":\"Play\",\"outputs\":[],\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"DrawNumber\",\"type\":\"uint32\"}],\"name\":\"Withdraw\",\"outputs\":[],\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"Announcements\",\"outputs\":[{\"name\":\"\",\"type\":\"string\"}],\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"DrawNumber\",\"type\":\"uint32\"}],\"name\":\"Refund\",\"outputs\":[],\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"IndexOfCurrentDraw\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"ledger\",\"outputs\":[{\"name\":\"WinningNum1\",\"type\":\"uint8\"},{\"name\":\"WinningNum2\",\"type\":\"uint8\"},{\"name\":\"WinningNum3\",\"type\":\"uint8\"},{\"name\":\"WinningNum4\",\"type\":\"uint8\"},{\"name\":\"TheRand\",\"type\":\"bytes32\"},{\"name\":\"TheHash\",\"type\":\"bytes32\"},{\"name\":\"Guess4OutOf4\",\"type\":\"uint256\"},{\"name\":\"Guess3OutOf4\",\"type\":\"uint256\"},{\"name\":\"Guess2OutOf4\",\"type\":\"uint256\"},{\"name\":\"Guess1OutOf4\",\"type\":\"uint256\"},{\"name\":\"PriceOfTicket\",\"type\":\"uint256\"},{\"name\":\"ExpirencyTime\",\"type\":\"uint256\"}],\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"DrawNumber\",\"type\":\"uint8\"},{\"name\":\"PlayerAddress\",\"type\":\"address\"}],\"name\":\"MyBet\",\"outputs\":[{\"name\":\"Nums\",\"type\":\"uint8[4]\"}],\"type\":\"function\"},{\"inputs\":[],\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"IndexOfDraw\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"TheHash\",\"type\":\"bytes32\"},{\"indexed\":false,\"name\":\"PriceOfTicketInWei\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"WeiToWin\",\"type\":\"uint256\"}],\"name\":\"NewDrawReadyToPlay\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"IndexOfDraw\",\"type\":\"uint32\"},{\"indexed\":false,\"name\":\"WinningNumber1\",\"type\":\"uint8\"},{\"indexed\":false,\"name\":\"WinningNumber2\",\"type\":\"uint8\"},{\"indexed\":false,\"name\":\"WinningNumber3\",\"type\":\"uint8\"},{\"indexed\":false,\"name\":\"WinningNumber4\",\"type\":\"uint8\"},{\"indexed\":false,\"name\":\"TheRand\",\"type\":\"bytes32\"}],\"name\":\"DrawReadyToPayout\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"Wei\",\"type\":\"uint256\"}],\"name\":\"PlayerWon\",\"type\":\"event\"},{\"constant\":true,\"inputs\":[{\"name\":\"Num1\",\"type\":\"uint8\"},{\"name\":\"Num2\",\"type\":\"uint8\"},{\"name\":\"Num3\",\"type\":\"uint8\"},{\"name\":\"Num4\",\"type\":\"uint8\"},{\"name\":\"TheRandomValue\",\"type\":\"bytes32\"}],\"name\":\"CheckHash\",\"outputs\":[{\"name\":\"TheHash\",\"type\":\"bytes32\"}],\"type\":\"function\"}]\r\n*/\r\n\r\n\r\n  \r\n//constructor\r\nfunction TheEthereumLottery()\r\n{\r\n  owner=msg.sender;\r\n  ledger.length=0;\r\n}\r\nmodifier OnlyOwner()\r\n{ // Modifier\r\n  if (msg.sender != owner) throw;\r\n  _\r\n}\r\naddress owner;\r\nstring public Announcements;//just additional feature\r\nuint public IndexOfCurrentDraw;//starting from 0\r\nstruct bet_t {\r\n  uint8[4] Nums;\r\n  bool can_withdraw;//default==false\r\n}\r\nstruct ledger_t {\r\n  uint8 WinningNum1;\r\n  uint8 WinningNum2;\r\n  uint8 WinningNum3;\r\n  uint8 WinningNum4;\r\n  bytes32 TheRand;\r\n  bytes32 TheHash;\r\n  mapping(address=>bet_t) bets;\r\n  uint Guess4OutOf4;\r\n  uint Guess3OutOf4;\r\n  uint Guess2OutOf4;\r\n  uint Guess1OutOf4;\r\n  uint PriceOfTicket;\r\n  uint ExpirencyTime;//for eventual refunds only, approx 2 weeks after draw announced\r\n}\r\nledger_t[] public ledger;\r\n \r\n//@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n//@@@@@@@@@@@ Here begines what probably you want to analise @@@@@@@@@@@\r\n//@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\nfunction next_draw(bytes32 new_hash,\r\n\t  uint priceofticket,\r\n\t  uint guess4outof4,\r\n\t  uint guess3outof4,\r\n\t  uint guess2outof4,\r\n\t  uint guess1outof4\r\n\t  )\r\nOnlyOwner\r\n{\r\n  ledger.length++;\r\n  IndexOfCurrentDraw=ledger.length-1;\r\n  ledger[IndexOfCurrentDraw].TheHash = new_hash;\r\n  ledger[IndexOfCurrentDraw].Guess4OutOf4=guess4outof4;\r\n  ledger[IndexOfCurrentDraw].Guess3OutOf4=guess3outof4;\r\n  ledger[IndexOfCurrentDraw].Guess2OutOf4=guess2outof4;\r\n  ledger[IndexOfCurrentDraw].Guess1OutOf4=guess1outof4;\r\n  ledger[IndexOfCurrentDraw].PriceOfTicket=priceofticket;\r\n  ledger[IndexOfCurrentDraw].ExpirencyTime=now + 2 weeks;//You can refund after ExpirencyTime if owner will not announce winningnums+TheRand satisfying TheHash \r\n\r\n  NewDrawReadyToPlay(IndexOfCurrentDraw, new_hash, priceofticket, guess4outof4);//event\r\n}\r\nfunction announce_numbers(uint8 no1,\r\n\t\t\t  uint8 no2,\r\n\t\t\t  uint8 no3,\r\n\t\t\t  uint8 no4,\r\n\t\t\t  uint32 index,\r\n\t\t\t  bytes32 the_rand\r\n\t\t\t  )\r\nOnlyOwner\r\n{\r\n  ledger[index].WinningNum1 = no1;\r\n  ledger[index].WinningNum2 = no2;\r\n  ledger[index].WinningNum3 = no3;\r\n  ledger[index].WinningNum4 = no4;\r\n  ledger[index].TheRand = the_rand;\r\n\r\n  DrawReadyToPayout(index,\r\n\t\t    no1, no2, no3, no4,\r\n\t\t    the_rand);//event\r\n}\r\nfunction Play(uint8 MyNum1,\r\n\t      uint8 MyNum2,\r\n\t      uint8 MyNum3,\r\n\t      uint8 MyNum4\r\n\t      )\r\n{\r\n  if(msg.value != ledger[IndexOfCurrentDraw].PriceOfTicket ||//to play you need to pay \r\n     ledger[IndexOfCurrentDraw].bets[msg.sender].Nums[3] != 0)//if your bet already exist\r\n    throw;\r\n\r\n  //if numbers are sorted\r\n  if(MyNum1 >= MyNum2 ||\r\n     MyNum2 >= MyNum3 ||\r\n     MyNum3 >= MyNum4\r\n     )\r\n    throw;//because you should sort the values yourself\r\n\r\n  ledger[IndexOfCurrentDraw].bets[msg.sender].Nums[0]=MyNum1;\r\n  ledger[IndexOfCurrentDraw].bets[msg.sender].Nums[1]=MyNum2;\r\n  ledger[IndexOfCurrentDraw].bets[msg.sender].Nums[2]=MyNum3;\r\n  ledger[IndexOfCurrentDraw].bets[msg.sender].Nums[3]=MyNum4;\r\n  ledger[IndexOfCurrentDraw].bets[msg.sender].can_withdraw=true;\r\n\r\n\r\n  //##########################################################################3\r\n  //another approach - with non-sorted input \r\n  /*\r\n  if(msg.value != ledger[IndexOfCurrentDraw].PriceOfTicket)\r\n    throw;\r\n\r\n  uint8[4] memory InputData;\r\n  (InputData[0],InputData[1],InputData[2],InputData[3])\r\n    =(MyNum1,MyNum2,MyNum3,MyNum4);\r\n  for(uint8 n=4;n>1;n--)//check if input is sorted / bubble sort\r\n    {\r\n      bool sorted=true; \r\n      for(uint8 i=0;i<n-1;i++)\r\n\tif(InputData[i] > InputData[i+1])//then mark array as not sorted & swap\r\n\t  {\r\n\t    sorted=false;\r\n\t    (InputData[i], InputData[i+1])=(InputData[i+1], InputData[i]);\r\n\t  }\r\n      if(sorted) break;//breaks as soon as the array is sorted\r\n    }\r\n  //now we can assign\r\n  ledger[IndexOfCurrentDraw].bets[msg.sender].Nums=InputData;\r\n  ledger[IndexOfCurrentDraw].bets[msg.sender].can_withdraw=true;\r\n  */\r\n\r\n  \r\n}\r\n\t\r\nfunction Withdraw(uint32 DrawNumber)\r\n{\r\n  if(msg.value!=0)\r\n    throw;//this function is free\r\n\r\n  if(ledger[DrawNumber].bets[msg.sender].can_withdraw==false)\r\n    throw;//throw if player didnt played\r\n\r\n  //by default, every non existing value is equal to 0\r\n  //so if there was no announcement WinningNums are zeros\r\n  if(ledger[DrawNumber].WinningNum4==0)//the least possible value == 3\r\n    throw;//this condition checks if the numbers were announced\r\n  //it's more gas-efficient than checking sha3(No1,No2,No3,No4,TheRand)\r\n  //and even if the hashes does not match then player benefits because of chance of win AND beeing able to Refund\r\n\r\n  \r\n  uint8 hits=0;\r\n  uint8 i=0;\r\n  uint8 j=0;\r\n  uint8[4] memory playernum=ledger[DrawNumber].bets[msg.sender].Nums;\r\n  uint8[4] memory nums;\r\n  (nums[0],nums[1],nums[2],nums[3])=\r\n    (ledger[DrawNumber].WinningNum1,\r\n     ledger[DrawNumber].WinningNum2,\r\n     ledger[DrawNumber].WinningNum3,\r\n     ledger[DrawNumber].WinningNum4);\r\n  //data ready\r\n  \r\n  while(i<4)//count player hits\r\n    {//both arrays are sorted\r\n      while(j<4 && playernum[j] < nums[i]) ++j;\r\n      if(j==4) break;//nothing more to check - break loop here\r\n      if(playernum[j] == nums[i]) ++hits;\r\n      ++i;\r\n    }\r\n  if(hits==0) throw;\r\n  uint256 win=0;\r\n  if(hits==1) win=ledger[DrawNumber].Guess1OutOf4;\r\n  if(hits==2) win=ledger[DrawNumber].Guess2OutOf4;\r\n  if(hits==3) win=ledger[DrawNumber].Guess3OutOf4;\r\n  if(hits==4) win=ledger[DrawNumber].Guess4OutOf4;\r\n    \r\n  ledger[DrawNumber].bets[msg.sender].can_withdraw=false;\r\n  if(!msg.sender.send(win)) //payment\r\n    throw;\r\n  PlayerWon(win);//event\r\n  if(!owner.send(win/100))\r\n    throw;//the fee is less than 1% (fee=1/101)\r\n}\r\nfunction Refund(uint32 DrawNumber)\r\n{\r\n  if(msg.value!=0)\r\n    throw;//this function is free\r\n\r\n  if(\r\n     sha3( ledger[DrawNumber].WinningNum1,\r\n\t   ledger[DrawNumber].WinningNum2,\r\n\t   ledger[DrawNumber].WinningNum3,\r\n\t   ledger[DrawNumber].WinningNum4,\r\n\t   ledger[DrawNumber].TheRand)\r\n     ==\r\n     ledger[DrawNumber].TheHash ) throw;\r\n  //no refund if hashes match\r\n\r\n  if(now < ledger[DrawNumber].ExpirencyTime)\r\n    throw;//no refund while there is still TIME to announce nums & TheRand\r\n  \r\n \r\n  if(ledger[DrawNumber].bets[msg.sender].can_withdraw==false)\r\n    throw;//throw if player didnt played\r\n  \r\n  ledger[DrawNumber].bets[msg.sender].can_withdraw=false;\r\n  if(!msg.sender.send(ledger[DrawNumber].PriceOfTicket)) //refund\r\n    throw;\r\n}\r\n//@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n//@@@@@@@@@@@ Here ends what probably you wanted to analise @@@@@@@@@@@@\r\n//@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n\r\nfunction CheckHash(uint8 Num1,\r\n\t\t   uint8 Num2,\r\n\t\t   uint8 Num3,\r\n\t\t   uint8 Num4,\r\n\t\t   bytes32 TheRandomValue\r\n\t\t   )\r\n  constant returns(bytes32 TheHash)\r\n{\r\n  return sha3(Num1, Num2, Num3, Num4, TheRandomValue);\r\n}\r\nfunction MyBet(uint8 DrawNumber, address PlayerAddress)\r\n  constant returns (uint8[4] Nums)\r\n{//check your nums\r\n  return ledger[DrawNumber].bets[PlayerAddress].Nums;\r\n}\r\nfunction announce(string MSG)\r\n  OnlyOwner\r\n{\r\n  Announcements=MSG;\r\n}\r\nevent NewDrawReadyToPlay(uint indexed IndexOfDraw,\r\n\t\t\t bytes32 TheHash,\r\n\t\t\t uint PriceOfTicketInWei,\r\n\t\t\t uint WeiToWin);\r\nevent DrawReadyToPayout(uint32 indexed IndexOfDraw,\r\n\t\t\tuint8 WinningNumber1,\r\n\t\t\tuint8 WinningNumber2,\r\n\t\t\tuint8 WinningNumber3,\r\n\t\t\tuint8 WinningNumber4,\r\n\t\t\tbytes32 TheRand);\r\nevent PlayerWon(uint Wei);\r\n\r\n\r\n\t\t\t      \r\n\r\n}//contract", "ABI": "[{\"constant\":true,\"inputs\":[{\"name\":\"Num1\",\"type\":\"uint8\"},{\"name\":\"Num2\",\"type\":\"uint8\"},{\"name\":\"Num3\",\"type\":\"uint8\"},{\"name\":\"Num4\",\"type\":\"uint8\"},{\"name\":\"TheRandomValue\",\"type\":\"bytes32\"}],\"name\":\"CheckHash\",\"outputs\":[{\"name\":\"TheHash\",\"type\":\"bytes32\"}],\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"ledger\",\"outputs\":[{\"name\":\"WinningNum1\",\"type\":\"uint8\"},{\"name\":\"WinningNum2\",\"type\":\"uint8\"},{\"name\":\"WinningNum3\",\"type\":\"uint8\"},{\"name\":\"WinningNum4\",\"type\":\"uint8\"},{\"name\":\"TheRand\",\"type\":\"bytes32\"},{\"name\":\"TheHash\",\"type\":\"bytes32\"},{\"name\":\"Guess4OutOf4\",\"type\":\"uint256\"},{\"name\":\"Guess3OutOf4\",\"type\":\"uint256\"},{\"name\":\"Guess2OutOf4\",\"type\":\"uint256\"},{\"name\":\"Guess1OutOf4\",\"type\":\"uint256\"},{\"name\":\"PriceOfTicket\",\"type\":\"uint256\"},{\"name\":\"ExpirencyTime\",\"type\":\"uint256\"}],\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"MyNum1\",\"type\":\"uint8\"},{\"name\":\"MyNum2\",\"type\":\"uint8\"},{\"name\":\"MyNum3\",\"type\":\"uint8\"},{\"name\":\"MyNum4\",\"type\":\"uint8\"}],\"name\":\"Play\",\"outputs\":[],\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"no1\",\"type\":\"uint8\"},{\"name\":\"no2\",\"type\":\"uint8\"},{\"name\":\"no3\",\"type\":\"uint8\"},{\"name\":\"no4\",\"type\":\"uint8\"},{\"name\":\"index\",\"type\":\"uint32\"},{\"name\":\"the_rand\",\"type\":\"bytes32\"}],\"name\":\"announce_numbers\",\"outputs\":[],\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"DrawNumber\",\"type\":\"uint32\"}],\"name\":\"Withdraw\",\"outputs\":[],\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"Announcements\",\"outputs\":[{\"name\":\"\",\"type\":\"string\"}],\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"new_hash\",\"type\":\"bytes32\"},{\"name\":\"priceofticket\",\"type\":\"uint256\"},{\"name\":\"guess4outof4\",\"type\":\"uint256\"},{\"name\":\"guess3outof4\",\"type\":\"uint256\"},{\"name\":\"guess2outof4\",\"type\":\"uint256\"},{\"name\":\"guess1outof4\",\"type\":\"uint256\"}],\"name\":\"next_draw\",\"outputs\":[],\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"DrawNumber\",\"type\":\"uint32\"}],\"name\":\"Refund\",\"outputs\":[],\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"IndexOfCurrentDraw\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"DrawNumber\",\"type\":\"uint8\"},{\"name\":\"PlayerAddress\",\"type\":\"address\"}],\"name\":\"MyBet\",\"outputs\":[{\"name\":\"Nums\",\"type\":\"uint8[4]\"}],\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"MSG\",\"type\":\"string\"}],\"name\":\"announce\",\"outputs\":[],\"type\":\"function\"},{\"inputs\":[],\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"IndexOfDraw\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"TheHash\",\"type\":\"bytes32\"},{\"indexed\":false,\"name\":\"PriceOfTicketInWei\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"WeiToWin\",\"type\":\"uint256\"}],\"name\":\"NewDrawReadyToPlay\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"IndexOfDraw\",\"type\":\"uint32\"},{\"indexed\":false,\"name\":\"WinningNumber1\",\"type\":\"uint8\"},{\"indexed\":false,\"name\":\"WinningNumber2\",\"type\":\"uint8\"},{\"indexed\":false,\"name\":\"WinningNumber3\",\"type\":\"uint8\"},{\"indexed\":false,\"name\":\"WinningNumber4\",\"type\":\"uint8\"},{\"indexed\":false,\"name\":\"TheRand\",\"type\":\"bytes32\"}],\"name\":\"DrawReadyToPayout\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"Wei\",\"type\":\"uint256\"}],\"name\":\"PlayerWon\",\"type\":\"event\"}]", "ContractName": "TheEthereumLottery", "CompilerVersion": "v0.3.6+commit.3fc68da", "OptimizationUsed": "1", "Runs": "200", "ConstructorArguments": "", "EVMVersion": "Default", "Library": "", "LicenseType": "", "Proxy": "0", "Implementation": "", "SwarmSource": ""}]}