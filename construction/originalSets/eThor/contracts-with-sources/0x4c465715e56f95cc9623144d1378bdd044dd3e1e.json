{"SourceCode":"/**\r\n * This contract manages the messages (or ads) to be displayed in the Pray4Prey aquarium.\r\n **/\r\n\r\ncontract mortal {\r\n\taddress owner;\r\n\r\n\tfunction mortal() {\r\n\t\towner = msg.sender;\r\n\t}\r\n\r\n\tfunction kill() {\r\n\t\tif (owner == msg.sender)\r\n\t\t\tsuicide(owner);\r\n\t}\r\n}\r\n\r\ncontract Display is mortal {\r\n\t/** the price per advertisement type per time interval (day, week, month). **/\r\n\tuint[][] prices;\r\n\t/** the duration of an interval in days **/\r\n\tuint16[] duration;\r\n\t/** list of advertisements per address **/\r\n\tAd[] ads;\r\n\t/** the expiry dates of the locks per adType*/\r\n\tuint[] locks;\r\n\r\n\tstruct Ad {\r\n\t\t//the id of the ad\r\n\t\tuint32 id;\r\n\t\t// the type of the ad\r\n\t\tuint8 adType;\r\n\t\t// the expiry timestamp \r\n\t\tuint expiry;\r\n\t\t//the corresponding address\r\n\t\taddress client;\r\n\t}\r\n\r\n\t/** \r\n\t * sets the default values\r\n\t **/\r\n\tfunction Display() {\r\n\t\tprices = [\r\n\t\t\t[100000000000000000, 300000000000000000, 500000000000000000],\r\n\t\t\t[500000000000000000, 1500000000000000000, 2500000000000000000],\r\n\t\t\t[2000000000000000000, 5000000000000000000, 8000000000000000000]\r\n\t\t];\r\n\t\tduration = [1, 7, 30];\r\n\t\tlocks = [now, now, now];\r\n\t}\r\n\r\n\t/** buys the basic ad **/\r\n\tfunction() payable {\r\n\t\tbuyAd(0, 0);\r\n\t}\r\n\r\n\t/** buys a specific ad**/\r\n\tfunction buyAd(uint8 adType, uint8 interval) payable {\r\n\t\tif (adType >= prices.length || interval >= duration.length || msg.value < prices[interval][adType]) throw;\r\n\t\tif (locks[adType] > now) throw;\r\n\t\tads.push(Ad(uint32(ads.length), adType, now + msg.value / prices[interval][adType] * duration[interval] * 1 days, msg.sender));\r\n\t}\r\n\r\n\t/** change the prices of an interval **/\r\n\tfunction changePrices(uint[3] newPrices, uint8 interval) {\r\n\t\tprices[interval] = newPrices;\r\n\t}\r\n\r\n\t/** let the owner withdraw the funds */\r\n\tfunction withdraw() {\r\n\t\tif (msg.sender == owner)\r\n\t\t\towner.send(address(this).balance);\r\n\t}\r\n\r\n\t/* returns 10 ads beginning from startindex */\r\n\tfunction get10Ads(uint startIndex) constant returns(uint32[10] ids, uint8[10] adTypes, uint[10] expiries, address[10] clients) {\r\n\t\tuint endIndex = startIndex + 10;\r\n\t\tif (endIndex > ads.length) endIndex = ads.length;\r\n\t\tuint j = 0;\r\n\t\tfor (uint i = startIndex; i < endIndex; i++) {\r\n\t\t\tids[j] = ads[i].id;\r\n\t\t\tadTypes[j] = (ads[i].adType);\r\n\t\t\texpiries[j] = (ads[i].expiry);\r\n\t\t\tclients[j] = (ads[i].client);\r\n\t\t\tj++;\r\n\t\t}\r\n\t}\r\n\r\n\t/** returns the number of ads **/\r\n\tfunction getNumAds() constant returns(uint) {\r\n\t\treturn ads.length;\r\n\t}\r\n\r\n\t/** returns the prices of an interval**/\r\n\tfunction getPricesPerInterval(uint8 interval) constant returns(uint[]) {\r\n\t\treturn prices[interval];\r\n\t}\r\n\r\n\t/** returns the price of a given type for a given interval**/\r\n\tfunction getPrice(uint8 adType, uint8 interval) constant returns(uint) {\r\n\t\treturn prices[interval][adType];\r\n\t}\r\n\r\n\t/** locks a type until a given date **/\r\n\tfunction lock(uint8 adType, uint expiry) {\r\n\t\tlocks[adType] = expiry;\r\n\t}\r\n}","ABI":"[{\"constant\":true,\"inputs\":[],\"name\":\"getNumAds\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"newPrices\",\"type\":\"uint256[3]\"},{\"name\":\"interval\",\"type\":\"uint8\"}],\"name\":\"changePrices\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"interval\",\"type\":\"uint8\"}],\"name\":\"getPricesPerInterval\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256[]\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"withdraw\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"kill\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"adType\",\"type\":\"uint8\"},{\"name\":\"interval\",\"type\":\"uint8\"}],\"name\":\"getPrice\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"startIndex\",\"type\":\"uint256\"}],\"name\":\"get10Ads\",\"outputs\":[{\"name\":\"ids\",\"type\":\"uint32[10]\"},{\"name\":\"adTypes\",\"type\":\"uint8[10]\"},{\"name\":\"expiries\",\"type\":\"uint256[10]\"},{\"name\":\"clients\",\"type\":\"address[10]\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"adType\",\"type\":\"uint8\"},{\"name\":\"expiry\",\"type\":\"uint256\"}],\"name\":\"lock\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"adType\",\"type\":\"uint8\"},{\"name\":\"interval\",\"type\":\"uint8\"}],\"name\":\"buyAd\",\"outputs\":[],\"payable\":true,\"type\":\"function\"},{\"inputs\":[],\"payable\":false,\"type\":\"constructor\"},{\"payable\":true,\"type\":\"fallback\"}]","ContractName":"Display","CompilerVersion":"v0.4.9+commit.364da425","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"","Library":"","LicenseType":"","SwarmSource":"bzzr://762070cdc8f9b8e20591e950ab620557aa3f52b3c1d956f88ca8789a3bf85426"}
