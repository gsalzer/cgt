{"SourceCode":"contract Etheramid1{\r\n\tfunction getParticipantById (uint id) constant public returns ( address inviter, address itself, uint totalPayout );\r\n\tfunction getParticipantCount () public constant returns ( uint count );\r\n}\r\ncontract Etheramid2 {\r\n\r\n    struct Participant {\r\n        address inviter;\r\n        address itself;\r\n        uint totalPayout;\r\n    }\r\n    \r\n    mapping (address => Participant) Tree;\r\n    mapping (uint => address) Index;\r\n\t\r\n\tuint Count = 0;\r\n    address public top;\r\n    uint constant contribution = 1 ether;\r\n\t\r\n \tEtheramid1 eth1 = Etheramid1(0x9758DA9B4D001Ed2d0DF46d25069Edf53750767a);\r\n\tuint oldUserCount = eth1.getParticipantCount();\r\n\t\r\n    function Etheramid2() {\r\n\t\tmoveOldUser(0);\r\n\t\ttop = Index[0];\r\n    }\r\n    \r\n    function() {\r\n\t\tthrow;\r\n    }\r\n    \r\n\tfunction moveOldUser (uint id) public {\r\n\t\taddress inviter; \r\n\t\taddress itself; \r\n\t\tuint totalPayout;\r\n\t\t(inviter, itself, totalPayout) = eth1.getParticipantById(id);\r\n\t\tif ((Tree[itself].inviter != 0x0) || (id >= oldUserCount)) throw;\r\n\t\taddParticipant(inviter, itself, totalPayout);\r\n\t}\r\n\t\r\n    function getParticipantById (uint id) constant public returns ( address inviter, address itself, uint totalPayout ){\r\n\t\tif (id >= Count) throw;\r\n\t\taddress ida = Index[id];\r\n        inviter = Tree[ida].inviter;\r\n        itself = Tree[ida].itself;\r\n        totalPayout = Tree[ida].totalPayout;\r\n    }\r\n\t\r\n\tfunction getParticipantByAddress (address adr) constant public returns ( address inviter, address itself, uint totalPayout ){\r\n\t\tif (Tree[adr].itself == 0x0) throw;\r\n        inviter = Tree[adr].inviter;\r\n        itself = Tree[adr].itself;\r\n        totalPayout = Tree[adr].totalPayout;\r\n    }\r\n    \r\n    function addParticipant(address inviter, address itself, uint totalPayout) private{\r\n        Index[Count] = itself;\r\n\t\tTree[itself] = Participant( {itself: itself, inviter: inviter, totalPayout: totalPayout});\r\n        Count +=1;\r\n    }\r\n    \r\n    function getParticipantCount () public constant returns ( uint count ){\r\n       count = Count;\r\n    }\r\n    \r\n    function enter(address inviter) public {\r\n        uint amount = msg.value;\r\n        if ((amount < contribution) || (Tree[msg.sender].inviter != 0x0) || (Tree[inviter].inviter == 0x0)) {\r\n            msg.sender.send(msg.value);\r\n            throw;\r\n        }\r\n        \r\n        addParticipant(inviter, msg.sender, 0);\r\n        address next = inviter;\r\n        uint rest = amount;\r\n        uint level = 1;\r\n        while ( (next != top) && (level < 7) ){\r\n            uint toSend = rest/2;\r\n            next.send(toSend);\r\n            Tree[next].totalPayout += toSend;\r\n            rest -= toSend;\r\n            next = Tree[next].inviter;\r\n            level++;\r\n        }\r\n        next.send(rest);\r\n\t\tTree[next].totalPayout += rest;\r\n    }\r\n}","ABI":"[{\"constant\":true,\"inputs\":[{\"name\":\"id\",\"type\":\"uint256\"}],\"name\":\"getParticipantById\",\"outputs\":[{\"name\":\"inviter\",\"type\":\"address\"},{\"name\":\"itself\",\"type\":\"address\"},{\"name\":\"totalPayout\",\"type\":\"uint256\"}],\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getParticipantCount\",\"outputs\":[{\"name\":\"count\",\"type\":\"uint256\"}],\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"inviter\",\"type\":\"address\"}],\"name\":\"enter\",\"outputs\":[],\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"id\",\"type\":\"uint256\"}],\"name\":\"moveOldUser\",\"outputs\":[],\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"adr\",\"type\":\"address\"}],\"name\":\"getParticipantByAddress\",\"outputs\":[{\"name\":\"inviter\",\"type\":\"address\"},{\"name\":\"itself\",\"type\":\"address\"},{\"name\":\"totalPayout\",\"type\":\"uint256\"}],\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"top\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"type\":\"function\"},{\"inputs\":[],\"type\":\"constructor\"}]","ContractName":"Etheramid2","CompilerVersion":"v0.3.2-2016-04-22-dd4300d","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"","Library":"","LicenseType":"","SwarmSource":""}
