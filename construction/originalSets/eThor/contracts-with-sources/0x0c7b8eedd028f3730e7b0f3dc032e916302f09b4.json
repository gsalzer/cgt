{"SourceCode":"//Contract Adress: 0xb58b2b121128719204d1F813F8B4100F63511F50\r\n//\r\n//Query \"CafeMaker.locked\": https://api.etherscan.io/api?module=proxy&action=eth_getStorageAt&address=0xb58b2b121128719204d1F813F8B4100F63511F50&position=0x0&tag=latest&apikey=YourApiKeyToken\r\n\r\ncontract CafeMaker{\r\n\r\n\tbool public locked = true;\r\n\r\n\tuint public CafePayed;\r\n\tuint public CafeDelivered;\r\n\r\n\r\n\tuint public PricePerCafe = 50000000000000000; //0.05 eth\r\n\taddress public DeviceOwner = msg.sender;\r\n\taddress public DeviceAddr;\r\n\r\n\tfunction RegisterDevice() {\r\n\t\tDeviceAddr = msg.sender;\r\n\t}\r\n\r\n\tfunction BookCafe(){\r\n\r\n\t\tif(DeviceAddr != msg.sender)\r\n\t\t\tthrow; //only the device can call this\r\n\r\n\t\tCafeDelivered += 1;\r\n\r\n\t\tif(CafePayed - CafeDelivered < 1)\r\n\t\t\tlocked=true;\r\n\r\n\t}\r\n\r\n\r\n\tfunction CollectMoney(uint amount){\r\n       if (!DeviceOwner.send(amount))\r\n            throw;\r\n\t\t\r\n\t}\r\n\r\n\r\n\t//ProcessIncomingPayment\r\n    function () {\r\n\r\n\t\tCafePayed += (msg.value / PricePerCafe);\r\n\r\n\t\tif(CafePayed - CafeDelivered < 1){\r\n\t\t\tlocked=true;\r\n\t\t} else {\r\n\t\t\tlocked=false;\r\n\t\t}\r\n\r\n    }\r\n}","ABI":"[{\"constant\":true,\"inputs\":[],\"name\":\"DeviceAddr\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"CafePayed\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"RegisterDevice\",\"outputs\":[],\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"PricePerCafe\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"CafeDelivered\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"DeviceOwner\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"locked\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"BookCafe\",\"outputs\":[],\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"CollectMoney\",\"outputs\":[],\"type\":\"function\"}]","ContractName":"CafeMaker","CompilerVersion":"v0.3.5-2016-06-10-5f97274","OptimizationUsed":"0","Runs":"200","ConstructorArguments":"","Library":"","LicenseType":"","SwarmSource":""}
