{"SourceCode":"// The contract that allows DTH that held DAO at a contract address to\r\n// authorize an enduser-account to do the withdrawal for them\r\n//\r\n// License: BSD3\r\n\r\ncontract Owned {\r\n    /// Prevents methods from perfoming any value transfer\r\n    modifier noEther() {if (msg.value > 0) throw; _}\r\n    /// Allows only the owner to call a function\r\n    modifier onlyOwner { if (msg.sender != owner) throw; _ }\r\n\r\n    address owner;\r\n\r\n    function Owned() { owner = msg.sender;}\r\n\r\n\r\n\r\n    function changeOwner(address _newOwner) onlyOwner {\r\n        owner = _newOwner;\r\n    }\r\n\r\n    function getOwner() noEther constant returns (address) {\r\n        return owner;\r\n    }\r\n}\r\n\r\ncontract WHAuthorizeAddress is Owned {\r\n\r\n    bool isClosed;\r\n\r\n    mapping (address => bool) usedAddresses;\r\n\r\n    event Authorize(address indexed dthContract, address indexed authorizedAddress);\r\n\r\n    function WHAuthorizeAddress () {\r\n        isClosed = false;\r\n    }\r\n\r\n    /// @notice Authorizes a regular account to act on behalf of a contract\r\n    /// @param _authorizedAddress The address of the regular account that will\r\n    ///                           act on behalf of the msg.sender contract.\r\n    function authorizeAddress(address _authorizedAddress) noEther() {\r\n\r\n        // after the contract is closed no more authorizations can happen\r\n        if (isClosed) {\r\n            throw;\r\n        }\r\n\r\n        // sender must be a contract and _authorizedAddress must be a user account\r\n        if (getCodeSize(msg.sender) == 0 || getCodeSize(_authorizedAddress) > 0) {\r\n            throw;\r\n        }\r\n\r\n        // An authorized address can be used to represent only a single contract.\r\n        if (usedAddresses[_authorizedAddress]) {\r\n            throw;\r\n        }\r\n        usedAddresses[_authorizedAddress] = true;\r\n\r\n        Authorize(msg.sender, _authorizedAddress);\r\n    }\r\n\r\n    function() {\r\n        throw;\r\n    }\r\n\r\n    function getCodeSize(address _addr) constant internal returns(uint _size) {\r\n        assembly {\r\n            _size := extcodesize(_addr)\r\n        }\r\n    }\r\n\r\n    /// @notice Close the contract. After closing no more authorizations can happen\r\n    function close() noEther onlyOwner {\r\n        isClosed = true;\r\n    }\r\n\r\n    function getIsClosed() noEther constant returns (bool) {\r\n        return isClosed;\r\n    }\r\n}","ABI":"[{\"constant\":true,\"inputs\":[],\"name\":\"getIsClosed\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"close\",\"outputs\":[],\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_authorizedAddress\",\"type\":\"address\"}],\"name\":\"authorizeAddress\",\"outputs\":[],\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getOwner\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_newOwner\",\"type\":\"address\"}],\"name\":\"changeOwner\",\"outputs\":[],\"type\":\"function\"},{\"inputs\":[],\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"dthContract\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"authorizedAddress\",\"type\":\"address\"}],\"name\":\"Authorize\",\"type\":\"event\"}]","ContractName":"WHAuthorizeAddress","CompilerVersion":"v0.3.6-2016-08-26-3eeefb5","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"","Library":"","LicenseType":"","SwarmSource":""}
